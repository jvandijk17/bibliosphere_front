<ng-container *ngIf="users && users.data.length > 0; else noUsers">
    <div class="table-container">

        <mat-toolbar color="primary">User List</mat-toolbar>

        <mat-form-field>
            <input matInput #input (keyup)="applyFilter(input.value)" placeholder="Filter">
        </mat-form-field>

        <mat-table [dataSource]="users" class="user-table">

            <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
            <mat-row *matRowDef="let user; columns: displayedColumns;"></mat-row>

            <!-- ID Column -->
            <ng-container matColumnDef="id">
                <mat-header-cell *matHeaderCellDef> ID </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.id }} </mat-cell>
            </ng-container>

            <!-- First Name Column -->
            <ng-container matColumnDef="first_name">
                <mat-header-cell *matHeaderCellDef> First Name </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.first_name }} </mat-cell>
            </ng-container>

            <!-- Last Name Column -->
            <ng-container matColumnDef="last_name">
                <mat-header-cell *matHeaderCellDef> Last Name </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.last_name }} </mat-cell>
            </ng-container>

            <!-- Email Column -->
            <ng-container matColumnDef="email">
                <mat-header-cell *matHeaderCellDef> Email </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.email }} </mat-cell>
            </ng-container>

            <!-- Address Column -->
            <ng-container matColumnDef="address">
                <mat-header-cell *matHeaderCellDef> Address </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.address }} </mat-cell>
            </ng-container>

            <!-- City Column -->
            <ng-container matColumnDef="city">
                <mat-header-cell *matHeaderCellDef> City </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.city }} </mat-cell>
            </ng-container>

            <!-- Province Column -->
            <ng-container matColumnDef="province">
                <mat-header-cell *matHeaderCellDef> Province </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.province }} </mat-cell>
            </ng-container>

            <!-- Postal Code Column -->
            <ng-container matColumnDef="postal_code">
                <mat-header-cell *matHeaderCellDef> Postal Code </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.postal_code }} </mat-cell>
            </ng-container>

            <!-- Birth Date Column -->
            <ng-container matColumnDef="birth_date">
                <mat-header-cell *matHeaderCellDef> Birth Date </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.birth_date | date:'shortDate' }}
                </mat-cell>
            </ng-container>

            <!-- Reputation Column -->
            <ng-container matColumnDef="reputation">
                <mat-header-cell *matHeaderCellDef> Reputation </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.reputation }} </mat-cell>
            </ng-container>

            <!-- Blocked Column -->
            <ng-container matColumnDef="blocked">
                <mat-header-cell *matHeaderCellDef> Blocked </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.blocked ? 'Yes' : 'No' }} </mat-cell>
            </ng-container>

            <!-- Roles Column -->
            <ng-container matColumnDef="roles">
                <mat-header-cell *matHeaderCellDef> Roles </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.roles?.join(', ') }} </mat-cell>
            </ng-container>

            <!-- Library Column -->
            <ng-container matColumnDef="library">
                <mat-header-cell *matHeaderCellDef> Library </mat-header-cell>
                <mat-cell *matCellDef="let user"> {{ user.libraryName }} </mat-cell>
            </ng-container>

            <!-- Actions Column - for Update and Delete actions -->
            <ng-container matColumnDef="actions">
                <mat-header-cell *matHeaderCellDef> Actions </mat-header-cell>
                <mat-cell *matCellDef="let user">
                    <!-- <button mat-icon-button (click)="updateUser(user)">
                        <mat-icon>edit_square</mat-icon>
                    </button>
                    <button mat-icon-button (click)="deleteUser(user)">
                        <mat-icon>delete</mat-icon>
                    </button> -->
                </mat-cell>
            </ng-container>


        </mat-table>
    </div>
</ng-container>

<ng-template #noUsers>
    <p>No users found.</p>
</ng-template>

<div *ngIf="loading" class="overlay">
    <mat-spinner></mat-spinner>
</div>